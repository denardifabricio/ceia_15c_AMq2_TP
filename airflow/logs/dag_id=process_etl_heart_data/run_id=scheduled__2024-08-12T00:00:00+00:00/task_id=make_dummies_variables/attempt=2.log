[2024-08-13T02:05:00.824+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: process_etl_heart_data.make_dummies_variables scheduled__2024-08-12T00:00:00+00:00 [queued]>
[2024-08-13T02:05:00.827+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: process_etl_heart_data.make_dummies_variables scheduled__2024-08-12T00:00:00+00:00 [queued]>
[2024-08-13T02:05:00.827+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2024-08-13T02:05:00.833+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonVirtualenvDecoratedOperator): make_dummies_variables> on 2024-08-12 00:00:00+00:00
[2024-08-13T02:05:00.835+0000] {standard_task_runner.py:60} INFO - Started process 1682 to run task
[2024-08-13T02:05:00.836+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'process_etl_heart_data', 'make_dummies_variables', 'scheduled__2024-08-12T00:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/etl_process.py', '--cfg-path', '/tmp/tmpw2dcucej']
[2024-08-13T02:05:00.838+0000] {standard_task_runner.py:88} INFO - Job 9: Subtask make_dummies_variables
[2024-08-13T02:05:00.858+0000] {task_command.py:423} INFO - Running <TaskInstance: process_etl_heart_data.make_dummies_variables scheduled__2024-08-12T00:00:00+00:00 [running]> on host 9c98cbfa0d20
[2024-08-13T02:05:00.889+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='Facundo Adrian Lucianna' AIRFLOW_CTX_DAG_ID='process_etl_heart_data' AIRFLOW_CTX_TASK_ID='make_dummies_variables' AIRFLOW_CTX_EXECUTION_DATE='2024-08-12T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-08-12T00:00:00+00:00'
[2024-08-13T02:05:00.890+0000] {process_utils.py:182} INFO - Executing cmd: /usr/local/bin/python -m virtualenv /tmp/venvdd5pd9p9 --system-site-packages --python=python
[2024-08-13T02:05:00.893+0000] {process_utils.py:186} INFO - Output:
[2024-08-13T02:05:01.205+0000] {process_utils.py:190} INFO - created virtual environment CPython3.8.18.final.0-64 in 154ms
[2024-08-13T02:05:01.206+0000] {process_utils.py:190} INFO -   creator CPython3Posix(dest=/tmp/venvdd5pd9p9, clear=False, no_vcs_ignore=False, global=True)
[2024-08-13T02:05:01.206+0000] {process_utils.py:190} INFO -   seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/tmp/tmpo2yycn2f)
[2024-08-13T02:05:01.206+0000] {process_utils.py:190} INFO -     added seed packages: pip==23.3.1, setuptools==69.0.2, wheel==0.42.0
[2024-08-13T02:05:01.206+0000] {process_utils.py:190} INFO -   activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
[2024-08-13T02:05:01.222+0000] {process_utils.py:182} INFO - Executing cmd: /tmp/venvdd5pd9p9/bin/pip install -r /tmp/venvdd5pd9p9/requirements.txt
[2024-08-13T02:05:01.225+0000] {process_utils.py:186} INFO - Output:
[2024-08-13T02:05:01.594+0000] {process_utils.py:190} INFO - WARNING: The directory '/home/***/.cache/pip' or its parent directory is not owned or is not writable by the current user. The cache has been disabled. Check the permissions and owner of that directory. If executing pip with sudo, you should use sudo's -H flag.
[2024-08-13T02:05:01.741+0000] {process_utils.py:190} INFO - Collecting awswrangler==3.6.0 (from -r /tmp/venvdd5pd9p9/requirements.txt (line 1))
[2024-08-13T02:05:01.814+0000] {process_utils.py:190} INFO -   Downloading awswrangler-3.6.0-py3-none-any.whl.metadata (23 kB)
[2024-08-13T02:05:01.836+0000] {process_utils.py:190} INFO - Requirement already satisfied: boto3<2.0.0,>=1.20.32 in /home/***/.local/lib/python3.8/site-packages (from awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (1.34.158)
[2024-08-13T02:05:01.836+0000] {process_utils.py:190} INFO - Requirement already satisfied: botocore<2.0.0,>=1.23.32 in /home/***/.local/lib/python3.8/site-packages (from awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (1.34.158)
[2024-08-13T02:05:01.837+0000] {process_utils.py:190} INFO - Requirement already satisfied: numpy<2.0,>=1.18 in /home/***/.local/lib/python3.8/site-packages (from awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (1.24.4)
[2024-08-13T02:05:01.837+0000] {process_utils.py:190} INFO - Requirement already satisfied: packaging<24.0,>=21.1 in /home/***/.local/lib/python3.8/site-packages (from awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (23.2)
[2024-08-13T02:05:01.838+0000] {process_utils.py:190} INFO - Requirement already satisfied: pandas<2.1.0,>=1.2.0 in /home/***/.local/lib/python3.8/site-packages (from awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (2.0.3)
[2024-08-13T02:05:01.838+0000] {process_utils.py:190} INFO - Requirement already satisfied: pyarrow>=7.0.0 in /home/***/.local/lib/python3.8/site-packages (from awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (14.0.2)
[2024-08-13T02:05:01.839+0000] {process_utils.py:190} INFO - Requirement already satisfied: typing-extensions<5.0.0,>=4.4.0 in /home/***/.local/lib/python3.8/site-packages (from awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (4.12.2)
[2024-08-13T02:05:01.841+0000] {process_utils.py:190} INFO - Requirement already satisfied: jmespath<2.0.0,>=0.7.1 in /home/***/.local/lib/python3.8/site-packages (from boto3<2.0.0,>=1.20.32->awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (0.10.0)
[2024-08-13T02:05:01.842+0000] {process_utils.py:190} INFO - Requirement already satisfied: s3transfer<0.11.0,>=0.10.0 in /home/***/.local/lib/python3.8/site-packages (from boto3<2.0.0,>=1.20.32->awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (0.10.2)
[2024-08-13T02:05:01.845+0000] {process_utils.py:190} INFO - Requirement already satisfied: python-dateutil<3.0.0,>=2.1 in /home/***/.local/lib/python3.8/site-packages (from botocore<2.0.0,>=1.23.32->awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (2.8.2)
[2024-08-13T02:05:01.845+0000] {process_utils.py:190} INFO - Requirement already satisfied: urllib3<1.27,>=1.25.4 in /home/***/.local/lib/python3.8/site-packages (from botocore<2.0.0,>=1.23.32->awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (1.26.18)
[2024-08-13T02:05:01.879+0000] {process_utils.py:190} INFO - Requirement already satisfied: pytz>=2020.1 in /home/***/.local/lib/python3.8/site-packages (from pandas<2.1.0,>=1.2.0->awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (2023.3.post1)
[2024-08-13T02:05:01.879+0000] {process_utils.py:190} INFO - Requirement already satisfied: tzdata>=2022.1 in /home/***/.local/lib/python3.8/site-packages (from pandas<2.1.0,>=1.2.0->awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (2023.4)
[2024-08-13T02:05:01.883+0000] {process_utils.py:190} INFO - Requirement already satisfied: six>=1.5 in /home/***/.local/lib/python3.8/site-packages (from python-dateutil<3.0.0,>=2.1->botocore<2.0.0,>=1.23.32->awswrangler==3.6.0->-r /tmp/venvdd5pd9p9/requirements.txt (line 1)) (1.16.0)
[2024-08-13T02:05:01.902+0000] {process_utils.py:190} INFO - Downloading awswrangler-3.6.0-py3-none-any.whl (403 kB)
[2024-08-13T02:05:01.930+0000] {process_utils.py:190} INFO -    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 403.8/403.8 kB 15.5 MB/s eta 0:00:00
[2024-08-13T02:05:03.100+0000] {process_utils.py:190} INFO - Installing collected packages: awswrangler
[2024-08-13T02:05:03.204+0000] {process_utils.py:190} INFO - Successfully installed awswrangler-3.6.0
[2024-08-13T02:05:03.271+0000] {process_utils.py:190} INFO - 
[2024-08-13T02:05:03.271+0000] {process_utils.py:190} INFO - [notice] A new release of pip is available: 23.3.1 -> 24.2
[2024-08-13T02:05:03.271+0000] {process_utils.py:190} INFO - [notice] To update, run: python -m pip install --upgrade pip
[2024-08-13T02:05:03.340+0000] {process_utils.py:182} INFO - Executing cmd: /tmp/venvdd5pd9p9/bin/python /tmp/venv-call_j7heeo4/script.py /tmp/venv-call_j7heeo4/script.in /tmp/venv-call_j7heeo4/script.out /tmp/venv-call_j7heeo4/string_args.txt /tmp/venv-call_j7heeo4/termination.log
[2024-08-13T02:05:03.343+0000] {process_utils.py:186} INFO - Output:
[2024-08-13T02:05:04.358+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:04.358+0000[0m] {[34mcredentials.py:[0m1147} INFO[0m - Found credentials in environment variables.[0m
[2024-08-13T02:05:04.386+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:04.386+0000[0m] {[34mconfigprovider.py:[0m952} INFO[0m - Found endpoint for s3 via: environment_service.[0m
[2024-08-13T02:05:04.410+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:04.410+0000[0m] {[34mcredentials.py:[0m1147} INFO[0m - Found credentials in environment variables.[0m
[2024-08-13T02:05:04.437+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:04.436+0000[0m] {[34mconfigprovider.py:[0m952} INFO[0m - Found endpoint for s3 via: environment_service.[0m
[2024-08-13T02:05:04.448+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:04.448+0000[0m] {[34mcredentials.py:[0m1147} INFO[0m - Found credentials in environment variables.[0m
[2024-08-13T02:05:04.475+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:04.475+0000[0m] {[34mconfigprovider.py:[0m952} INFO[0m - Found endpoint for s3 via: environment_service.[0m
[2024-08-13T02:05:04.591+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:04.591+0000[0m] {[34mconnectionpool.py:[0m824} WARNING[0m - Retrying (JitteredRetry(total=4, connect=4, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5fd25d90>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=Heart+Disease[0m
[2024-08-13T02:05:08.602+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:08.601+0000[0m] {[34mconnectionpool.py:[0m824} WARNING[0m - Retrying (JitteredRetry(total=3, connect=3, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5d689bb0>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=Heart+Disease[0m
[2024-08-13T02:05:16.610+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:16.609+0000[0m] {[34mconnectionpool.py:[0m824} WARNING[0m - Retrying (JitteredRetry(total=2, connect=2, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5d689a60>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=Heart+Disease[0m
[2024-08-13T02:05:32.634+0000] {process_utils.py:190} INFO - [[34m2024-08-13T02:05:32.634+0000[0m] {[34mconnectionpool.py:[0m824} WARNING[0m - Retrying (JitteredRetry(total=1, connect=1, read=5, redirect=5, status=5)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff5d689e80>: Failed to establish a new connection: [Errno 111] Connection refused')': /api/2.0/mlflow/experiments/get-by-name?experiment_name=Heart+Disease[0m
[2024-08-13T02:05:46.104+0000] {local_task_job_runner.py:302} WARNING - State of this instance has been externally set to None. Terminating instance.
[2024-08-13T02:05:46.105+0000] {process_utils.py:131} INFO - Sending 15 to group 1682. PIDs of all processes in the group: [1737, 1682]
[2024-08-13T02:05:46.105+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 1682
[2024-08-13T02:05:46.106+0000] {taskinstance.py:2450} ERROR - Received SIGTERM. Terminating subprocesses.
[2024-08-13T02:05:46.132+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/decorators/base.py", line 241, in execute
    return_value = super().execute(context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 400, in execute
    return super().execute(context=serializable_context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 716, in execute_callable
    result = self._execute_python_callable_in_subprocess(python_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 454, in _execute_python_callable_in_subprocess
    execute_in_subprocess(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/process_utils.py", line 171, in execute_in_subprocess
    execute_in_subprocess_with_kwargs(cmd, cwd=cwd)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/process_utils.py", line 189, in execute_in_subprocess_with_kwargs
    for line in iter(proc.stdout.readline, b""):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 2452, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal
[2024-08-13T02:05:46.135+0000] {taskinstance.py:1138} INFO - Marking task as FAILED. dag_id=process_etl_heart_data, task_id=make_dummies_variables, execution_date=20240812T000000, start_date=20240813T020500, end_date=20240813T020546
[2024-08-13T02:05:46.144+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 9 for task make_dummies_variables ((psycopg2.errors.ForeignKeyViolation) insert or update on table "task_fail" violates foreign key constraint "task_fail_ti_fkey"
DETAIL:  Key (dag_id, task_id, run_id, map_index)=(process_etl_heart_data, make_dummies_variables, scheduled__2024-08-12T00:00:00+00:00, -1) is not present in table "task_instance".

[SQL: INSERT INTO task_fail (task_id, dag_id, run_id, map_index, start_date, end_date, duration) VALUES (%(task_id)s, %(dag_id)s, %(run_id)s, %(map_index)s, %(start_date)s, %(end_date)s, %(duration)s) RETURNING task_fail.id]
[parameters: {'task_id': 'make_dummies_variables', 'dag_id': 'process_etl_heart_data', 'run_id': 'scheduled__2024-08-12T00:00:00+00:00', 'map_index': -1, 'start_date': datetime.datetime(2024, 8, 13, 2, 5, 0, 824683, tzinfo=Timezone('UTC')), 'end_date': datetime.datetime(2024, 8, 13, 2, 5, 46, 134537, tzinfo=Timezone('UTC')), 'duration': 45}]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 1682)
[2024-08-13T02:05:46.163+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=1682, status='terminated', exitcode=1, started='02:05:00') (1682) terminated with exit code 1
[2024-08-13T02:05:46.163+0000] {process_utils.py:79} INFO - Process psutil.Process(pid=1737, status='terminated', started='02:05:02') (1737) terminated with exit code None
